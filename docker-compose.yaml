version: '3.8'

services:
  nethermind:
    image: nethermind/nethermind
    container_name: nethermind
    volumes:
      - ./nethermind.config.json:/home/nethermind/.nethermind/config.json
      - nethermind_data:/data
    ports:
      - "8545:8545"   # JSON-RPC port
      - "8546:8546"   # WebSocket port
      - "30303:30303" # P2P port
      - "9090:9090"   # Prometheus metrics
      - "8551:8551"   # Engine JSON-RPC port
    command: -c /home/nethermind/.nethermind/config.json

  lighthouse:
    image: sigp/lighthouse
    container_name: lighthouse
    command: lighthouse bn \
      --network mainnet \
      --http \
      --http-address 0.0.0.0 \
      --http-port 5052 \
      --eth1-endpoints http://nethermind:8545
    ports:
      - "5052:5052"   # Beacon API port
    volumes:
      - lighthouse_data:/root/.lighthouse

volumes:
  nethermind_data:
  lighthouse_data: